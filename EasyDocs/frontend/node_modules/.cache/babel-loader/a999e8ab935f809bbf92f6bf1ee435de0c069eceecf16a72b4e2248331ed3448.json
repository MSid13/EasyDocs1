{"ast":null,"code":"var _jsxFileName = \"/Users/smantrala/Documents/GitHub/EasyDocs/frontend/src/YjsQuillEditor.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport Quill from 'quill';\nimport * as Y from 'yjs';\nimport { QuillBinding } from 'y-quill';\nimport { WebsocketProvider } from 'y-websocket';\nimport 'quill/dist/quill.snow.css';\nconst toolbarOptions = [['bold', 'italic', 'underline', 'strike'], ['blockquote', 'code-block'], [{\n  'header': 1\n}, {\n  'header': 2\n}], [{\n  'list': 'ordered'\n}, {\n  'list': 'bullet'\n}], [{\n  'script': 'sub'\n}, {\n  'script': 'super'\n}], [{\n  'indent': '-1'\n}, {\n  'indent': '+1'\n}], [{\n  'direction': 'rtl'\n}], [{\n  'size': ['small', false, 'large', 'huge']\n}], [{\n  'header': [1, 2, 3, 4, 5, 6, false]\n}], [{\n  'color': []\n}, {\n  'background': []\n}], [{\n  'font': []\n}], [{\n  'align': []\n}], ['clean']];\nimport { forwardRef, useImperativeHandle } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst YjsQuillEditor = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(function YjsQuillEditor({\n  docId,\n  readOnly,\n  userId,\n  initialContent\n}, ref) {\n  _s();\n  const editorRef = useRef();\n  const ydocRef = useRef();\n  const providerRef = useRef();\n  const bindingRef = useRef();\n  const quillRef = useRef();\n  useImperativeHandle(ref, () => ({\n    getQuill: () => quillRef.current\n  }), []);\n  useEffect(() => {\n    // Remove any existing toolbar DOM nodes to prevent duplicates\n    if (editorRef.current) {\n      var _editorRef$current$pa;\n      const toolbars = (_editorRef$current$pa = editorRef.current.parentNode) === null || _editorRef$current$pa === void 0 ? void 0 : _editorRef$current$pa.querySelectorAll('.ql-toolbar');\n      toolbars === null || toolbars === void 0 ? void 0 : toolbars.forEach(tb => tb.remove());\n    }\n    // Create Yjs doc and provider\n    ydocRef.current = new Y.Doc();\n    providerRef.current = new WebsocketProvider('ws://localhost:1234', `doc-${docId}`, ydocRef.current);\n    const ytext = ydocRef.current.getText('quill');\n    quillRef.current = new Quill(editorRef.current, {\n      theme: 'snow',\n      readOnly,\n      modules: {\n        toolbar: toolbarOptions\n      }\n    });\n    bindingRef.current = new QuillBinding(ytext, quillRef.current, providerRef.current.awareness);\n\n    // Set initial content if provided and not already set\n    if (initialContent) {\n      try {\n        const delta = JSON.parse(initialContent);\n        // Only set if different from current\n        if (JSON.stringify(quillRef.current.getContents()) !== JSON.stringify(delta)) {\n          quillRef.current.setContents(delta);\n        }\n      } catch (e) {\n        // fallback: set as HTML\n        quillRef.current.clipboard.dangerouslyPasteHTML(initialContent);\n      }\n    }\n\n    // Periodically save to backend\n    // Remove autosave for now, rely on manual save\n\n    return () => {\n      providerRef.current.destroy();\n      ydocRef.current.destroy();\n      // Clean up toolbars on unmount\n      if (editorRef.current) {\n        var _editorRef$current$pa2;\n        const toolbars = (_editorRef$current$pa2 = editorRef.current.parentNode) === null || _editorRef$current$pa2 === void 0 ? void 0 : _editorRef$current$pa2.querySelectorAll('.ql-toolbar');\n        toolbars === null || toolbars === void 0 ? void 0 : toolbars.forEach(tb => tb.remove());\n      }\n    };\n  }, [docId, readOnly, userId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#fff',\n      borderRadius: 12,\n      boxShadow: '0 2px 16px rgba(0,0,0,0.08)',\n      padding: 24,\n      marginBottom: 24,\n      maxWidth: 800,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      minHeight: 350\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: editorRef,\n      style: {\n        height: 300\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}, \"U3cCN87DLoYUET8wWqHsBxnp31Q=\")), \"U3cCN87DLoYUET8wWqHsBxnp31Q=\");\n_c2 = YjsQuillEditor;\nexport default YjsQuillEditor;\nvar _c, _c2;\n$RefreshReg$(_c, \"YjsQuillEditor$forwardRef\");\n$RefreshReg$(_c2, \"YjsQuillEditor\");","map":{"version":3,"names":["React","useEffect","useRef","Quill","Y","QuillBinding","WebsocketProvider","toolbarOptions","forwardRef","useImperativeHandle","jsxDEV","_jsxDEV","YjsQuillEditor","_s","_c","docId","readOnly","userId","initialContent","ref","editorRef","ydocRef","providerRef","bindingRef","quillRef","getQuill","current","_editorRef$current$pa","toolbars","parentNode","querySelectorAll","forEach","tb","remove","Doc","ytext","getText","theme","modules","toolbar","awareness","delta","JSON","parse","stringify","getContents","setContents","e","clipboard","dangerouslyPasteHTML","destroy","_editorRef$current$pa2","style","background","borderRadius","boxShadow","padding","marginBottom","maxWidth","marginLeft","marginRight","minHeight","children","height","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["/Users/smantrala/Documents/GitHub/EasyDocs/frontend/src/YjsQuillEditor.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport Quill from 'quill';\nimport * as Y from 'yjs';\nimport { QuillBinding } from 'y-quill';\nimport { WebsocketProvider } from 'y-websocket';\nimport 'quill/dist/quill.snow.css';\n\nconst toolbarOptions = [\n  ['bold', 'italic', 'underline', 'strike'],\n  ['blockquote', 'code-block'],\n  [{ 'header': 1 }, { 'header': 2 }],\n  [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n  [{ 'script': 'sub'}, { 'script': 'super' }],\n  [{ 'indent': '-1'}, { 'indent': '+1' }],\n  [{ 'direction': 'rtl' }],\n  [{ 'size': ['small', false, 'large', 'huge'] }],\n  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n  [{ 'color': [] }, { 'background': [] }],\n  [{ 'font': [] }],\n  [{ 'align': [] }],\n  ['clean']\n];\n\nimport { forwardRef, useImperativeHandle } from 'react';\n\nconst YjsQuillEditor = forwardRef(function YjsQuillEditor({ docId, readOnly, userId, initialContent }, ref) {\n  const editorRef = useRef();\n  const ydocRef = useRef();\n  const providerRef = useRef();\n  const bindingRef = useRef();\n  const quillRef = useRef();\n\n  useImperativeHandle(ref, () => ({\n    getQuill: () => quillRef.current\n  }), []);\n\n  useEffect(() => {\n    // Remove any existing toolbar DOM nodes to prevent duplicates\n    if (editorRef.current) {\n      const toolbars = editorRef.current.parentNode?.querySelectorAll('.ql-toolbar');\n      toolbars?.forEach(tb => tb.remove());\n    }\n    // Create Yjs doc and provider\n    ydocRef.current = new Y.Doc();\n    providerRef.current = new WebsocketProvider('ws://localhost:1234', `doc-${docId}`, ydocRef.current);\n    const ytext = ydocRef.current.getText('quill');\n    quillRef.current = new Quill(editorRef.current, {\n      theme: 'snow',\n      readOnly,\n      modules: { toolbar: toolbarOptions }\n    });\n\n    bindingRef.current = new QuillBinding(ytext, quillRef.current, providerRef.current.awareness);\n\n    // Set initial content if provided and not already set\n    if (initialContent) {\n      try {\n        const delta = JSON.parse(initialContent);\n        // Only set if different from current\n        if (JSON.stringify(quillRef.current.getContents()) !== JSON.stringify(delta)) {\n          quillRef.current.setContents(delta);\n        }\n      } catch (e) {\n        // fallback: set as HTML\n        quillRef.current.clipboard.dangerouslyPasteHTML(initialContent);\n      }\n    }\n\n    // Periodically save to backend\n    // Remove autosave for now, rely on manual save\n\n    return () => {\n      providerRef.current.destroy();\n      ydocRef.current.destroy();\n      // Clean up toolbars on unmount\n      if (editorRef.current) {\n        const toolbars = editorRef.current.parentNode?.querySelectorAll('.ql-toolbar');\n        toolbars?.forEach(tb => tb.remove());\n      }\n    };\n  }, [docId, readOnly, userId]);\n\n  return (\n    <div style={{\n      background: '#fff',\n      borderRadius: 12,\n      boxShadow: '0 2px 16px rgba(0,0,0,0.08)',\n      padding: 24,\n      marginBottom: 24,\n      maxWidth: 800,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      minHeight: 350\n    }}>\n      <div ref={editorRef} style={{ height: 300 }} />\n    </div>\n  );\n});\n\nexport default YjsQuillEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}