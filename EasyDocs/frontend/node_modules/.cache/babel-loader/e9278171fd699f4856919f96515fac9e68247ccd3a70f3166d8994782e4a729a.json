{"ast":null,"code":"var _jsxFileName = \"/Users/smantrala/Documents/GitHub/EasyDocs/frontend/src/YjsQuillEditor.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport Quill from 'quill';\nimport * as Y from 'yjs';\nimport { QuillBinding } from 'y-quill';\nimport { WebsocketProvider } from 'y-websocket';\nimport 'quill/dist/quill.snow.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst toolbarOptions = [['bold', 'italic', 'underline', 'strike'], ['blockquote', 'code-block'], [{\n  'header': 1\n}, {\n  'header': 2\n}], [{\n  'list': 'ordered'\n}, {\n  'list': 'bullet'\n}], [{\n  'script': 'sub'\n}, {\n  'script': 'super'\n}], [{\n  'indent': '-1'\n}, {\n  'indent': '+1'\n}], [{\n  'direction': 'rtl'\n}], [{\n  'size': ['small', false, 'large', 'huge']\n}], [{\n  'header': [1, 2, 3, 4, 5, 6, false]\n}], [{\n  'color': []\n}, {\n  'background': []\n}], [{\n  'font': []\n}], [{\n  'align': []\n}], ['clean']];\nexport default function YjsQuillEditor({\n  docId,\n  readOnly,\n  userId\n}) {\n  _s();\n  const editorRef = useRef();\n  const ydocRef = useRef();\n  const providerRef = useRef();\n  const bindingRef = useRef();\n  const quillRef = useRef();\n  useEffect(() => {\n    // Remove any existing toolbar DOM nodes to prevent duplicates\n    if (editorRef.current) {\n      var _editorRef$current$pa;\n      const toolbars = (_editorRef$current$pa = editorRef.current.parentNode) === null || _editorRef$current$pa === void 0 ? void 0 : _editorRef$current$pa.querySelectorAll('.ql-toolbar');\n      toolbars === null || toolbars === void 0 ? void 0 : toolbars.forEach(tb => tb.remove());\n    }\n    // Create Yjs doc and provider\n    ydocRef.current = new Y.Doc();\n    providerRef.current = new WebsocketProvider('ws://localhost:1234', `doc-${docId}`, ydocRef.current);\n    const ytext = ydocRef.current.getText('quill');\n    quillRef.current = new Quill(editorRef.current, {\n      theme: 'snow',\n      readOnly,\n      modules: {\n        toolbar: toolbarOptions\n      }\n    });\n    bindingRef.current = new QuillBinding(ytext, quillRef.current, providerRef.current.awareness);\n\n    // Periodically save to backend\n    let saveInterval;\n    if (!readOnly && userId) {\n      saveInterval = setInterval(() => {\n        const content = JSON.stringify(quillRef.current.getContents());\n        fetch(`/api/docs/${docId}/save`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            user_id: userId,\n            content\n          })\n        });\n      }, 5000); // Save every 5 seconds\n    }\n    return () => {\n      if (saveInterval) clearInterval(saveInterval);\n      providerRef.current.destroy();\n      ydocRef.current.destroy();\n      // Clean up toolbars on unmount\n      if (editorRef.current) {\n        var _editorRef$current$pa2;\n        const toolbars = (_editorRef$current$pa2 = editorRef.current.parentNode) === null || _editorRef$current$pa2 === void 0 ? void 0 : _editorRef$current$pa2.querySelectorAll('.ql-toolbar');\n        toolbars === null || toolbars === void 0 ? void 0 : toolbars.forEach(tb => tb.remove());\n      }\n    };\n  }, [docId, readOnly, userId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#fff',\n      borderRadius: 12,\n      boxShadow: '0 2px 16px rgba(0,0,0,0.08)',\n      padding: 24,\n      marginBottom: 24,\n      maxWidth: 800,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      minHeight: 350\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: editorRef,\n      style: {\n        height: 300\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n}\n_s(YjsQuillEditor, \"tx5I4g5faR9tAgoflD2O5se4pPo=\");\n_c = YjsQuillEditor;\nvar _c;\n$RefreshReg$(_c, \"YjsQuillEditor\");","map":{"version":3,"names":["React","useEffect","useRef","Quill","Y","QuillBinding","WebsocketProvider","jsxDEV","_jsxDEV","toolbarOptions","YjsQuillEditor","docId","readOnly","userId","_s","editorRef","ydocRef","providerRef","bindingRef","quillRef","current","_editorRef$current$pa","toolbars","parentNode","querySelectorAll","forEach","tb","remove","Doc","ytext","getText","theme","modules","toolbar","awareness","saveInterval","setInterval","content","JSON","stringify","getContents","fetch","method","headers","body","user_id","clearInterval","destroy","_editorRef$current$pa2","style","background","borderRadius","boxShadow","padding","marginBottom","maxWidth","marginLeft","marginRight","minHeight","children","ref","height","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/smantrala/Documents/GitHub/EasyDocs/frontend/src/YjsQuillEditor.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport Quill from 'quill';\nimport * as Y from 'yjs';\nimport { QuillBinding } from 'y-quill';\nimport { WebsocketProvider } from 'y-websocket';\nimport 'quill/dist/quill.snow.css';\n\nconst toolbarOptions = [\n  ['bold', 'italic', 'underline', 'strike'],\n  ['blockquote', 'code-block'],\n  [{ 'header': 1 }, { 'header': 2 }],\n  [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n  [{ 'script': 'sub'}, { 'script': 'super' }],\n  [{ 'indent': '-1'}, { 'indent': '+1' }],\n  [{ 'direction': 'rtl' }],\n  [{ 'size': ['small', false, 'large', 'huge'] }],\n  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n  [{ 'color': [] }, { 'background': [] }],\n  [{ 'font': [] }],\n  [{ 'align': [] }],\n  ['clean']\n];\n\nexport default function YjsQuillEditor({ docId, readOnly, userId }) {\n  const editorRef = useRef();\n  const ydocRef = useRef();\n  const providerRef = useRef();\n  const bindingRef = useRef();\n  const quillRef = useRef();\n\n  useEffect(() => {\n    // Remove any existing toolbar DOM nodes to prevent duplicates\n    if (editorRef.current) {\n      const toolbars = editorRef.current.parentNode?.querySelectorAll('.ql-toolbar');\n      toolbars?.forEach(tb => tb.remove());\n    }\n    // Create Yjs doc and provider\n    ydocRef.current = new Y.Doc();\n    providerRef.current = new WebsocketProvider('ws://localhost:1234', `doc-${docId}`, ydocRef.current);\n    const ytext = ydocRef.current.getText('quill');\n    quillRef.current = new Quill(editorRef.current, {\n      theme: 'snow',\n      readOnly,\n      modules: { toolbar: toolbarOptions }\n    });\n    bindingRef.current = new QuillBinding(ytext, quillRef.current, providerRef.current.awareness);\n\n    // Periodically save to backend\n    let saveInterval;\n    if (!readOnly && userId) {\n      saveInterval = setInterval(() => {\n        const content = JSON.stringify(quillRef.current.getContents());\n        fetch(`/api/docs/${docId}/save`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            user_id: userId,\n            content\n          })\n        });\n      }, 5000); // Save every 5 seconds\n    }\n\n    return () => {\n      if (saveInterval) clearInterval(saveInterval);\n      providerRef.current.destroy();\n      ydocRef.current.destroy();\n      // Clean up toolbars on unmount\n      if (editorRef.current) {\n        const toolbars = editorRef.current.parentNode?.querySelectorAll('.ql-toolbar');\n        toolbars?.forEach(tb => tb.remove());\n      }\n    };\n  }, [docId, readOnly, userId]);\n\n  return (\n    <div style={{\n      background: '#fff',\n      borderRadius: 12,\n      boxShadow: '0 2px 16px rgba(0,0,0,0.08)',\n      padding: 24,\n      marginBottom: 24,\n      maxWidth: 800,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      minHeight: 350\n    }}>\n      <div ref={editorRef} style={{ height: 300 }} />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}